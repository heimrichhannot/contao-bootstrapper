(function(a){Bootstrapper={init:function(){this.initFastClick();this.toggleCollapseFromHash();this.openModalFromHash();this.toggleTabFromHash();this.initModalNavigation();this.initNavbar();this.navFollowLinkIfItemsOpen();this.supportNestedDropdowns();this.initModal();this.loadModalFromUrl();this.onCloseModal();this.initCarouselProgressBar();this.addPlaceholderTagSupport();this.initJQueryValidation();this.initAjaxForms();this.initScrollClass();this.megaMenuEqualHeight();this.setHashFromCollapse();this.followAnchor();this.initFileUpload();this.slideUpCollapse();this.initIosLabelBugFix();this.initTinyMceModalBugFix();a(document).ajaxComplete(a.proxy(this.ajaxComplete,this))},locale:"de",ajaxComplete:function(){this.initJQueryValidation()},slideUpCollapse:function(){a(".collapse.slideup").on("show.bs.collapse",function(){a("html, body").animate({scrollTop:a(document).height()},"slow")})},initFileUpload:function(){a(".fileinput [data-dismiss]").on("click",function(){var b=a(this).parent(".fileinput");b.fileinput("clear");b.find("input[type=file]").attr("value","")})},megaMenuEqualHeight:function(){a('[data-equal-height="ul.nav"]').each(function(){var d=a(this),c=0,b=0;d.find(d.data("equal-height")).each(function(){var e=a(this).actual("innerHeight");actualOuterHeight=a(this).actual("outerHeight",{includeMargin:true});if(actualOuterHeight>b){b=actualOuterHeight}if(e>c){c=e}});d.height(b);d.find(".submenu-wrapper").height(c)})},supportNestedDropdowns:function(){a("ul.dropdown-menu").on("click",'a[data-toggle="dropdown"]',function(b){b.preventDefault();b.stopPropagation();a("ul.dropdown-menu [data-toggle=dropdown]").parent().removeClass("open");a(this).parent().addClass("open")})},initScrollClass:function(){a(window).on("scroll",function(c){var b=a(window).scrollTop();a('[data-spy="scroll"]').each(function(){var e=a(this),d=e.data("scrollclass"),f=e.data("offset")?e.data("offset"):1;if(d==null){return true}if(b>f){e.addClass(d)}else{e.removeClass(d)}})})},initNavbar:function(){a(".navbar-collapse").on("shown.bs.collapse",function(){a("body").addClass("navbar-xs-open")});a(".navbar-collapse").on("hide.bs.collapse",function(){a("body").removeClass("navbar-xs-open")});if(a(".navbar-collapse").hasClass("in")){a("body").addClass("navbar-xs-open")}},addPlaceholderTagSupport:function(){if(!Modernizr.input.placeholder){a("input, textarea").placeholder()}},initJQueryValidation:function(){var b=a("form.jquery-validation");if(b.length>0){a.validator.addMethod("checkbox",function(f,d){var c=false,e=a(d).closest(".form-group");if(e.find(".control-label:first .mandatory").length>0){e.find("input[type=checkbox]").each(function(){if(this.checked){c=true;return false}});return c}return true},a.validator.format("Dieses Feld ist ein Pflichtfeld."));b.each(function(){a(this).validate({errorClass:"error",focusInvalid:false,errorPlacement:function(d,e){var c=e.closest(".input-group");if(c.length>0){d.insertAfter(c)}else{d.appendTo(e.closest(".form-group"))}}})})}},initAjaxForms:function(){a("body").on("submit",".ajax-form",function(d){var b=a(this),c=b.serializeArray();d.preventDefault();c.push({name:"isAjax",value:"1"});a.ajax(b.attr("action"),{data:c,method:a(this).attr("method"),success:function(g){var e,g="<div>"+g+"</div>";if(b.data("replace")){e=a(g).find(b.data("replace"));if(e!==undefined){a(b.data("replace")).html(e)}}else{e=a(g).find("#"+b.attr("id"));if(e.length<1){b.html(g);e=b}else{b.replaceWith(e)}}var h=e.find(".alert:first, .error:first");if(h.length>0){var f=h.offset();a("html,body").animate({scrollTop:parseInt(f.top)-70+"px"},500)}}})})},initCarouselProgressBar:function(){var h=0,g=a(".carousel-progress .progress-bar"),i=g.find(".sr-only"),f=a(".carousel"),c=200,e=Math.floor(c*100/parseInt(f.data("interval")));if(f.length<=0){return}function d(){if(h>0){g.removeClass("carousel-transition")}if(h>=100){i.text("100%");g.css({width:"100%"});h=100;f.carousel("next");g.addClass("carousel-transition");return false}g.css({width:h+"%"});i.text(h+"%");h+=e}var b=setInterval(d,c);f.carousel({interval:false,pause:false}).on("slide.bs.carousel",function(){clearInterval(b)}).on("slid.bs.carousel",function(){h=0;b=setInterval(d,c)});f.hover(function(){clearInterval(b)},function(){b=setInterval(d,c)});f.on("click",".carousel-control, .carousel-indicators",function(){h=0;clearInterval(b);g.addClass("carousel-transition").css({width:"0%"})})},initModal:function(){a("body").on("click",'[data-toggle="modal"]',function(f){var d=a(this),c=a(d.data("target")),b=c.find(".modal-dialog");if(typeof d.attr("href")==="undefined"||d.attr("href").charAt(0)=="#"){return true}f.preventDefault();if(window.history&&window.history.pushState){history.pushState({url:d.attr("href")},null,d.attr("href"))}a.ajax({url:d.attr("href"),data:{scope:"modal",target:c.attr("id")}}).done(function(h,j,g){try{dataJson=a.parseJSON(h);if(dataJson.type=="redirect"){if(typeof history.replaceState!=="undefined"){history.replaceState({url:dataJson.url},null,dataJson.url)}b.load(dataJson.url,function(k,l,e){c.modal("show")});return false}}catch(i){}b.html(h);c.modal("show")});return false})},onCloseModal:function(){a(".modal").on("hide.bs.modal",function(c){var b=a(this);b.find("iframe").each(function(){var d=a(this);d.attr("src",d.attr("src").replace("autoplay=1","autoplay=0"))});b.find("audio, video").each(function(){this.pause()});if(window.history&&window.history.pushState){if(b.data("history-base-filtered")){history.pushState({url:b.data("history-base-filtered")},null,b.data("history-base-filtered"))}else{history.pushState({url:b.data("history-base")},null,b.data("history-base"))}}})},loadModalFromUrl:function(){if(a(".modal.in").length>0){a(".modal.in").modal("show")}},setHashFromCollapse:function(){var b=a(".collapse");b.each(function(){var c=a(this);c.on("shown.bs.collapse",function(d){if(this.id&&window.history&&window.history.pushState){history.pushState({},document.title,location.pathname+location.search+"#"+this.id)}});c.on("hidden.bs.collapse",function(d){if(this.id&&typeof history.replaceState!=="undefined"){history.replaceState({},document.title,location.pathname+location.search)}});if(c.hasClass("in")){if(c.attr("id")&&window.history&&window.history.pushState){history.pushState({},document.title,location.pathname+location.search+"#"+c.attr("id"))}}})},followAnchor:function(){a("a[href*=#]:not([data-toggle])").on("click",function(){var c=document.createElement("a");c.href=a(this).attr("href");if(c.href.split("#")[0]!=window.location.href.split("#")[0]){return true}return b(c.hash)});function b(d){if(d==""){return true}var c=a(d);if(c.length>0){Bootstrapper.scrollTo(c,100,500);window.location.hash=d;return false}return true}},toggleCollapseFromHash:function(){var e=location.hash.replace(/#/g,"");if(!e){return false}var c=a("#"+e+".collapse"),b=a("[href='#"+e+"']");if(c.length<1){return false}var d=a(b.data("parent"));if(d.length>0){a(b.data("parent")).find(".collapse").removeClass("in");a(b.data("parent")).find("[data-toggle=collapse]").addClass("collapsed")}c.addClass("in");b.removeClass("collapsed");Bootstrapper.scrollTo(c,100,500)},scrollTo:function(d,c,b,e){setTimeout(function(){if(!Bootstrapper.elementInViewport(d)||typeof e!=="undefined"){a("html, body").animate({scrollTop:(d.offset().top-c)},"slow")}},b)},elementInViewport:function(d){d=d.get(0);var f=d.offsetTop;var e=d.offsetLeft;var c=d.offsetWidth;var b=d.offsetHeight;while(d.offsetParent){d=d.offsetParent;f+=d.offsetTop;e+=d.offsetLeft}return(f<(window.pageYOffset+window.innerHeight)&&e<(window.pageXOffset+window.innerWidth)&&(f+b)>window.pageYOffset&&(e+c)>window.pageXOffset)},openModalFromHash:function(){var c=location.hash.replace(/#/g,"").replace(/is/g,"or");if(!c){return false}var b=a("#"+c);if(b.length<1||!b.hasClass("modal")){return false}b.modal("show")},toggleTabFromHash:function(){var e=location.hash.replace(/#/g,"");if(!e){return false}var d=a("#"+e),c=a("[href='#"+e+"']");var f=c.closest(".tabcontrol_tabs"),b=d.closest(".tabcontrol_panes");if(f.length>0&&b.length>0){f.find("a").parent().removeClass("active");b.find(".tab-pane").removeClass("in").removeClass("active");d.addClass("active").addClass("in");c.parent().addClass("active")}},initModalNavigation:function(){a(".modal").on("click",".modal-next",function(b){b.preventDefault();window.location=a(this).attr("href")})},initModalRemoteUpdate:function(){a("body").on("hidden.bs.modal",".modal",function(){a(this).removeData("bs.modal")});a('a[data-toggle="modal"][data-remote]').on("click",function(d){d.preventDefault();var c=a(this),b=a(c.data("target"));a.ajax({url:c.attr("href")}).done(function(e){b.find(".modal-content").replaceWith(e).end().modal()});return false})},navFollowLinkIfItemsOpen:function(){a(".nav-collapse").on("click",'a[data-toggle="dropdown"]',function(d){var c=a(this),b=c.parent("li");if(this.href!==undefined&&b.hasClass("open")){if(this.target.length){window.open(this.href,this.target)}else{window.location=this.href}}})},initFastClick:function(){FastClick.attach(document.body)},initIosLabelBugFix:function(){a(".ios .checkbox-label, .ios .radio-label").each(function(){a(this).on("click",function(){var c=a(this).siblings("input"),b=a(this).closest(".checkbox.checkbox-inline");if(c.length>0){c.trigger("click")}if(b.length>0){b.find("input").trigger("click")}})})},initTinyMceModalBugFix:function(){a(document).on("focusin",function(b){if(a(b.target).closest(".mce-window").length){b.stopImmediatePropagation()}})},setLocale:function(b){this.locale=b},confirm:function(c,d,b){bootbox.dialog({message:c,buttons:{error:{label:this.locale=="en"?"No":"Nein",className:"btn-default",callback:b},success:{label:this.locale=="en"?"Yes":"Ja",className:"btn-primary",callback:d}}})}};a(document).ready(function(){Bootstrapper.init()})})(jQuery);