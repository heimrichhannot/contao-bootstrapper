(function(){function l(r,c){var q;c=c||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=c.touchBoundary||10;this.layer=r;this.tapDelay=c.tapDelay||200;if(l.notNeeded(r)){return}function f(m,n){return function(){return m.apply(n,arguments)}}var d=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];var a=this;for(var b=0,e=d.length;b<e;b++){a[d[b]]=f(a[d[b]],a)}if(g){r.addEventListener("mouseover",this.onMouse,true);r.addEventListener("mousedown",this.onMouse,true);r.addEventListener("mouseup",this.onMouse,true)}r.addEventListener("click",this.onClick,true);r.addEventListener("touchstart",this.onTouchStart,false);r.addEventListener("touchmove",this.onTouchMove,false);r.addEventListener("touchend",this.onTouchEnd,false);r.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){r.removeEventListener=function(m,o,n){var p=Node.prototype.removeEventListener;if(m==="click"){p.call(r,m,o.hijacked||o,n)}else{p.call(r,m,o,n)}};r.addEventListener=function(p,o,m){var n=Node.prototype.addEventListener;if(p==="click"){n.call(r,p,o.hijacked||(o.hijacked=function(t){if(!t.propagationStopped){o(t)}}),m)}else{n.call(r,p,o,m)}}}if(typeof r.onclick==="function"){q=r.onclick;r.addEventListener("click",function(m){q(m)},false);r.onclick=null}}var g=navigator.userAgent.indexOf("Android")>0;var i=/iP(ad|hone|od)/.test(navigator.userAgent);var k=i&&(/OS 4_\d(_\d)?/).test(navigator.userAgent);var j=i&&(/OS ([6-9]|\d{2})_\d/).test(navigator.userAgent);var h=navigator.userAgent.indexOf("BB10")>0;l.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled){return true}break;case"input":if((i&&a.type==="file")||a.disabled){return true}break;case"label":case"video":return true}return(/\bneedsclick\b/).test(a.className)};l.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return true;case"select":return !g;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return !a.disabled&&!a.readOnly;default:return(/\bneedsfocus\b/).test(a.className)}};l.prototype.sendClick=function(c,b){var d,a;if(document.activeElement&&document.activeElement!==c){document.activeElement.blur()}a=b.changedTouches[0];d=document.createEvent("MouseEvents");d.initMouseEvent(this.determineEventType(c),true,true,window,1,a.screenX,a.screenY,a.clientX,a.clientY,false,false,false,false,0,null);d.forwardedTouchEvent=true;c.dispatchEvent(d)};l.prototype.determineEventType=function(a){if(g&&a.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};l.prototype.focus=function(b){var a;if(i&&b.setSelectionRange&&b.type.indexOf("date")!==0&&b.type!=="time"){a=b.value.length;b.setSelectionRange(a,a)}else{b.focus()}};l.prototype.updateScrollParent=function(b){var a,c;a=b.fastClickScrollParent;if(!a||!a.contains(b)){c=b;do{if(c.scrollHeight>c.offsetHeight){a=c;b.fastClickScrollParent=c;break}c=c.parentElement}while(c)}if(a){a.fastClickLastScrollTop=a.scrollTop}};l.prototype.getTargetElementFromEventTarget=function(a){if(a.nodeType===Node.TEXT_NODE){return a.parentNode}return a};l.prototype.onTouchStart=function(b){var d,a,c;if(b.targetTouches.length>1){return true}d=this.getTargetElementFromEventTarget(b.target);a=b.targetTouches[0];if(i){c=window.getSelection();if(c.rangeCount&&!c.isCollapsed){return true}if(!k){if(a.identifier&&a.identifier===this.lastTouchIdentifier){b.preventDefault();return false}this.lastTouchIdentifier=a.identifier;this.updateScrollParent(d)}}this.trackingClick=true;this.trackingClickStart=b.timeStamp;this.targetElement=d;this.touchStartX=a.pageX;this.touchStartY=a.pageY;if((b.timeStamp-this.lastClickTime)<this.tapDelay){b.preventDefault()}return true};l.prototype.touchHasMoved=function(c){var a=c.changedTouches[0],b=this.touchBoundary;if(Math.abs(a.pageX-this.touchStartX)>b||Math.abs(a.pageY-this.touchStartY)>b){return true}return false};l.prototype.onTouchMove=function(a){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a)){this.trackingClick=false;this.targetElement=null}return true};l.prototype.findControl=function(a){if(a.control!==undefined){return a.control}if(a.htmlFor){return document.getElementById(a.htmlFor)}return a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};l.prototype.onTouchEnd=function(e){var c,d,f,a,b,n=this.targetElement;if(!this.trackingClick){return true}if((e.timeStamp-this.lastClickTime)<this.tapDelay){this.cancelNextClick=true;return true}this.cancelNextClick=false;this.lastClickTime=e.timeStamp;d=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(j){b=e.changedTouches[0];n=document.elementFromPoint(b.pageX-window.pageXOffset,b.pageY-window.pageYOffset)||n;n.fastClickScrollParent=this.targetElement.fastClickScrollParent}f=n.tagName.toLowerCase();if(f==="label"){c=this.findControl(n);if(c){this.focus(n);if(g){return false}n=c}}else{if(this.needsFocus(n)){if((e.timeStamp-d)>100||(i&&window.top!==window&&f==="input")){this.targetElement=null;return false}this.focus(n);this.sendClick(n,e);if(!i||f!=="select"){this.targetElement=null;e.preventDefault()}return false}}if(i&&!k){a=n.fastClickScrollParent;if(a&&a.fastClickLastScrollTop!==a.scrollTop){return true}}if(!this.needsClick(n)){e.preventDefault();this.sendClick(n,e)}return false};l.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};l.prototype.onMouse=function(a){if(!this.targetElement){return true}if(a.forwardedTouchEvent){return true}if(!a.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(a.stopImmediatePropagation){a.stopImmediatePropagation()}else{a.propagationStopped=true}a.stopPropagation();a.preventDefault();return false}return true};l.prototype.onClick=function(b){var a;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(b.target.type==="submit"&&b.detail===0){return true}a=this.onMouse(b);if(!a){this.targetElement=null}return a};l.prototype.destroy=function(){var a=this.layer;if(g){a.removeEventListener("mouseover",this.onMouse,true);a.removeEventListener("mousedown",this.onMouse,true);a.removeEventListener("mouseup",this.onMouse,true)}a.removeEventListener("click",this.onClick,true);a.removeEventListener("touchstart",this.onTouchStart,false);a.removeEventListener("touchmove",this.onTouchMove,false);a.removeEventListener("touchend",this.onTouchEnd,false);a.removeEventListener("touchcancel",this.onTouchCancel,false)};l.notNeeded=function(c){var d;var a;var b;if(typeof window.ontouchstart==="undefined"){return true}a=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(a){if(g){d=document.querySelector("meta[name=viewport]");if(d){if(d.content.indexOf("user-scalable=no")!==-1){return true}if(a>31&&document.documentElement.scrollWidth<=window.outerWidth){return true}}}else{return true}}if(h){b=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(b[1]>=10&&b[2]>=3){d=document.querySelector("meta[name=viewport]");if(d){if(d.content.indexOf("user-scalable=no")!==-1){return true}if(document.documentElement.scrollWidth<=window.outerWidth){return true}}}}if(c.style.msTouchAction==="none"){return true}return false};l.attach=function(a,b){return new l(a,b)};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(function(){return l})}else{if(typeof module!=="undefined"&&module.exports){module.exports=l.attach;module.exports.FastClick=l}else{window.FastClick=l}}}());