var fs=require("fs");module.exports=function(e){e.loadNpmTasks("grunt-bower-cli");e.loadNpmTasks("grunt-contrib-uglify");e.loadNpmTasks("grunt-contrib-concat");e.loadNpmTasks("grunt-contrib-clean");e.loadNpmTasks("grunt-contrib-copy");e.loadNpmTasks("grunt-contrib-less");e.loadNpmTasks("grunt-replace");e.registerTask("configure",["clean:pre","bower:install",]);e.registerTask("compile",["copy:less","copy:less_plugins","concat:less_theme_dependencies","concat:less_plugins","concat:js","less:uncompressed","clean_bootstrap2_css","replace","build_standalone","uglify","clean:post",]);e.registerTask("default",["configure","compile"]);e.registerTask("clean_bootstrap2_css","Cleans CSS rules ocurring before the header comment.",function(){var f="dist/css/selectize.bootstrap2.css";var g=fs.readFileSync(f,"utf8");e.file.write(f,g.replace(/^(.|\s)+?\/\*/m,"/*"));e.log.writeln('Cleaned "'+f+'".')});e.registerTask("build_standalone","",function(){var j,h,m,k,g,l,f=[];j=[];for(h=0,m=a.length;h<m;h++){l=a[h];g=l.match(/([^\/]+?).js$/)[1];k=e.file.read(l).replace("define(factory);","define('"+g+"', factory);");f.push(k)}l="dist/js/selectize.js";k=e.file.read(l).replace(/define\((.*?)factory\);/,"define('selectize', $1factory);");f.push(k);l="dist/js/standalone/selectize.js";e.file.write(l,f.join("\n\n"));e.log.writeln('Built "'+l+'".')});var d=["src/contrib/*.js","src/*.js","!src/.wrapper.js","!src/defaults.js","!src/selectize.js","!src/selectize.jquery.js","src/selectize.js","src/defaults.js","src/selectize.jquery.js",];var a=["bower_components/sifter/sifter.js","bower_components/microplugin/src/microplugin.js",];var b=[];var c=[];(function(){var j=e.option("plugins");if(!j){return}if(j.indexOf(",")!==-1){j="{"+j.split(/\s*,\s*/).join(",")+"}"}d.push("src/plugins/"+j+"/*.js");var f=e.file.expand(["src/plugins/"+j+"/plugin.less"]);for(var h=0,k=f.length;h<k;h++){var g=f[h].match(/src\/plugins\/(.+?)\//)[1];b.push('@import "plugins/'+g+'";');c.push({src:f[h],dest:"dist/less/plugins/"+g+".less"})}})();e.initConfig({pkg:e.file.readJSON("bower.json"),bower:{install:{options:{directory:"bower_components",action:"install"}}},clean:{pre:["dist"],post:["**/*.tmp*"]},copy:{less:{files:[{expand:true,flatten:true,src:["src/less/*.less"],dest:"dist/less"}]},less_plugins:{files:c}},replace:{options:{prefix:"@@"},main:{options:{variables:{version:"<%= pkg.version %>",js:'<%= grunt.file.read("dist/js/selectize.js").replace(/\\n/g, "\\n\\t") %>',css:'<%= grunt.file.read("dist/css/selectize.css") %>',},},files:[{src:["src/.wrapper.js"],dest:"dist/js/selectize.js"},{src:["src/less/.wrapper.css"],dest:"dist/css/selectize.css"}]},css_post:{options:{variables:{version:"<%= pkg.version %>"},},files:[{expand:true,flatten:false,src:["dist/css/*.css"],dest:""},{expand:true,flatten:false,src:["dist/less/*.less"],dest:""},{expand:true,flatten:false,src:["dist/less/plugins/*.less"],dest:""},]}},less:{options:{},uncompressed:{files:{"dist/css/selectize.css":["dist/less/selectize.less"],"dist/css/selectize.default.css":["dist/less/selectize.default.less"],"dist/css/selectize.legacy.css":["dist/less/selectize.legacy.less"],"dist/css/selectize.bootstrap2.css":["dist/less/selectize.bootstrap2.tmp.less"],"dist/css/selectize.bootstrap3.css":["dist/less/selectize.bootstrap3.tmp.less"]}}},concat:{options:{stripBanners:true,separator:e.util.linefeed+e.util.linefeed},js:{files:{"dist/js/selectize.js":d,}},less_plugins:{options:{banner:b.join("\n")+e.util.linefeed+e.util.linefeed},files:{"dist/less/selectize.less":["dist/less/selectize.less"]}},less_theme_dependencies:{options:{stripBanners:false},files:{"dist/less/selectize.bootstrap2.tmp.less":["bower_components/bootstrap2/less/variables.less","bower_components/bootstrap2/less/mixins.less","dist/less/selectize.bootstrap2.less"],"dist/less/selectize.bootstrap3.tmp.less":["bower_components/bootstrap3/less/variables.less","bower_components/bootstrap3/less/mixins/nav-divider.less","dist/less/selectize.bootstrap3.less"]}}},uglify:{main:{options:{banner:"/*! selectize.js - v<%= pkg.version %> | https://github.com/brianreavis/selectize.js | Apache License (v2) */\n",report:"gzip","ascii-only":true},files:{"dist/js/selectize.min.js":["dist/js/selectize.js"],"dist/js/standalone/selectize.min.js":["dist/js/standalone/selectize.js"]}}}})};