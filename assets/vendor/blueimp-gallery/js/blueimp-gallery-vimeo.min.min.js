(function(b){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery-video"],b)}else{b(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}}(function(i,h){if(!window.postMessage){return h}i.extend(h.prototype.options,{vimeoVideoIdProperty:"vimeo",vimeoPlayerUrl:"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID",vimeoPlayerIdPrefix:"vimeo-player-",vimeoClickToPlay:true});var f=h.prototype.textFactory||h.prototype.imageFactory,j=function(b,a,c,d){this.url=b;this.videoId=a;this.playerId=c;this.clickToPlay=d;this.element=document.createElement("div");this.listeners={}},g=0;i.extend(j.prototype,{canPlayType:function(){return true},on:function(b,a){this.listeners[b]=a;return this},loadAPI:function(){var d=this,b="//"+(location.protocol==="https"?"secure-":"")+"a.vimeocdn.com/js/froogaloop2.min.js",c=document.getElementsByTagName("script"),o=c.length,e,n,a=function(){if(!n&&d.playOnReady){d.play()}n=true};while(o){o-=1;if(c[o].src===b){e=c[o];break}}if(!e){e=document.createElement("script");e.src=b}i(e).on("load",a);c[0].parentNode.insertBefore(e,c[0]);if(/loaded|complete/.test(e.readyState)){a()}},onReady:function(){var a=this;this.ready=true;this.player.addEvent("play",function(){a.hasPlayed=true;a.onPlaying()});this.player.addEvent("pause",function(){a.onPause()});this.player.addEvent("finish",function(){a.onPause()});if(this.playOnReady){this.play()}},onPlaying:function(){if(this.playStatus<2){this.listeners.playing();this.playStatus=2}},onPause:function(){this.listeners.pause();delete this.playStatus},insertIframe:function(){var a=document.createElement("iframe");a.src=this.url.replace("VIDEO_ID",this.videoId).replace("PLAYER_ID",this.playerId);a.id=this.playerId;this.element.parentNode.replaceChild(a,this.element);this.element=a},play:function(){var a=this;if(!this.playStatus){this.listeners.play();this.playStatus=1}if(this.ready){if(!this.hasPlayed&&(this.clickToPlay||(window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform)))){this.onPlaying()}else{this.player.api("play")}}else{this.playOnReady=true;if(!window.$f){this.loadAPI()}else{if(!this.player){this.insertIframe();this.player=$f(this.element);this.player.addEvent("ready",function(){a.onReady()})}}}},pause:function(){if(this.ready){this.player.api("pause")}else{if(this.playStatus){delete this.playOnReady;this.listeners.pause();delete this.playStatus}}}});i.extend(h.prototype,{VimeoPlayer:j,textFactory:function(b,a){var d=this.options,c=this.getItemProperty(b,d.vimeoVideoIdProperty);if(c){if(this.getItemProperty(b,d.urlProperty)===undefined){b[d.urlProperty]="//vimeo.com/"+c}g+=1;return this.videoFactory(b,a,new j(d.vimeoPlayerUrl,c,d.vimeoPlayerIdPrefix+g,d.vimeoClickToPlay))}return f.call(this,b,a)}});return h}));