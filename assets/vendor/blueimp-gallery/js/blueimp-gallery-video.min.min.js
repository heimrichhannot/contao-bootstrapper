(function(b){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery"],b)}else{b(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}}(function(d,f){d.extend(f.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"});var e=f.prototype.handleSlide;d.extend(f.prototype,{handleSlide:function(a){e.call(this,a);if(this.playingVideo){this.playingVideo.pause()}},videoFactory:function(A,F,z){var E=this,I=this.options,y=this.elementPrototype.cloneNode(false),J=d(y),C=[{type:"error",target:y}],c=z||document.createElement("video"),G=this.getItemProperty(A,I.urlProperty),H=this.getItemProperty(A,I.typeProperty),a=this.getItemProperty(A,I.titleProperty),b=this.getItemProperty(A,I.videoPosterProperty),B,K=this.getItemProperty(A,I.videoSourcesProperty),x,D,w,L;J.addClass(I.videoContentClass);if(a){y.title=a}if(c.canPlayType){if(G&&H&&c.canPlayType(H)){c.src=G}else{while(K&&K.length){x=K.shift();G=this.getItemProperty(x,I.urlProperty);H=this.getItemProperty(x,I.typeProperty);if(G&&H&&c.canPlayType(H)){c.src=G;break}}}}if(b){c.poster=b;B=this.imagePrototype.cloneNode(false);d(B).addClass(I.toggleClass);B.src=b;B.draggable=false;y.appendChild(B)}D=document.createElement("a");D.setAttribute("target","_blank");if(!z){D.setAttribute("download",a)}D.href=G;if(c.src){c.controls=true;(z||d(c)).on("error",function(){E.setTimeout(F,C)}).on("pause",function(){w=false;J.removeClass(E.options.videoLoadingClass).removeClass(E.options.videoPlayingClass);if(L){E.container.addClass(E.options.controlsClass)}delete E.playingVideo;if(E.interval){E.play()}}).on("playing",function(){w=false;J.removeClass(E.options.videoLoadingClass).addClass(E.options.videoPlayingClass);if(E.container.hasClass(E.options.controlsClass)){L=true;E.container.removeClass(E.options.controlsClass)}else{L=false}}).on("play",function(){window.clearTimeout(E.timeout);w=true;J.addClass(E.options.videoLoadingClass);E.playingVideo=c});d(D).on("click",function(g){E.preventDefault(g);if(w){c.pause()}else{c.play()}});y.appendChild((z&&z.element)||c)}y.appendChild(D);this.setTimeout(F,[{type:"load",target:y}]);return y}});return f}));