(function(a){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery-video"],a)}else{a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}}(function(d,e){if(!window.postMessage){return e}d.extend(e.prototype.options,{vimeoVideoIdProperty:"vimeo",vimeoPlayerUrl:"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID",vimeoPlayerIdPrefix:"vimeo-player-",vimeoClickToPlay:true});var b=e.prototype.textFactory||e.prototype.imageFactory,c=function(h,i,g,f){this.url=h;this.videoId=i;this.playerId=g;this.clickToPlay=f;this.element=document.createElement("div");this.listeners={}},a=0;d.extend(c.prototype,{canPlayType:function(){return true},on:function(f,g){this.listeners[f]=g;return this},loadAPI:function(){var j=this,l="//"+(location.protocol==="https"?"secure-":"")+"a.vimeocdn.com/js/froogaloop2.min.js",k=document.getElementsByTagName("script"),f=k.length,h,g,m=function(){if(!g&&j.playOnReady){j.play()}g=true};while(f){f-=1;if(k[f].src===l){h=k[f];break}}if(!h){h=document.createElement("script");h.src=l}d(h).on("load",m);k[0].parentNode.insertBefore(h,k[0]);if(/loaded|complete/.test(h.readyState)){m()}},onReady:function(){var f=this;this.ready=true;this.player.addEvent("play",function(){f.hasPlayed=true;f.onPlaying()});this.player.addEvent("pause",function(){f.onPause()});this.player.addEvent("finish",function(){f.onPause()});if(this.playOnReady){this.play()}},onPlaying:function(){if(this.playStatus<2){this.listeners.playing();this.playStatus=2}},onPause:function(){this.listeners.pause();delete this.playStatus},insertIframe:function(){var f=document.createElement("iframe");f.src=this.url.replace("VIDEO_ID",this.videoId).replace("PLAYER_ID",this.playerId);f.id=this.playerId;this.element.parentNode.replaceChild(f,this.element);this.element=f},play:function(){var f=this;if(!this.playStatus){this.listeners.play();this.playStatus=1}if(this.ready){if(!this.hasPlayed&&(this.clickToPlay||(window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform)))){this.onPlaying()}else{this.player.api("play")}}else{this.playOnReady=true;if(!window.$f){this.loadAPI()}else{if(!this.player){this.insertIframe();this.player=$f(this.element);this.player.addEvent("ready",function(){f.onReady()})}}}},pause:function(){if(this.ready){this.player.api("pause")}else{if(this.playStatus){delete this.playOnReady;this.listeners.pause();delete this.playStatus}}}});d.extend(e.prototype,{VimeoPlayer:c,textFactory:function(h,i){var f=this.options,g=this.getItemProperty(h,f.vimeoVideoIdProperty);if(g){if(this.getItemProperty(h,f.urlProperty)===undefined){h[f.urlProperty]="//vimeo.com/"+g}a+=1;return this.videoFactory(h,i,new c(f.vimeoPlayerUrl,g,f.vimeoPlayerIdPrefix+a,f.vimeoClickToPlay))}return b.call(this,h,i)}});return e}));