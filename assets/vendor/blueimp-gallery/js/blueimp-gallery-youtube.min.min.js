(function(b){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery-video"],b)}else{b(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}}(function(h,g){if(!window.postMessage){return g}h.extend(g.prototype.options,{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:true});var e=g.prototype.textFactory||g.prototype.imageFactory,f=function(b,a,c){this.videoId=b;this.playerVars=a;this.clickToPlay=c;this.element=document.createElement("div");this.listeners={}};h.extend(f.prototype,{canPlayType:function(){return true},on:function(b,a){this.listeners[b]=a;return this},loadAPI:function(){var c=this,l=window.onYouTubeIframeAPIReady,a="//www.youtube.com/iframe_api",b=document.getElementsByTagName("script"),i=b.length,d;window.onYouTubeIframeAPIReady=function(){if(l){l.apply(this)}if(c.playOnReady){c.play()}};while(i){i-=1;if(b[i].src===a){return}}d=document.createElement("script");d.src=a;b[0].parentNode.insertBefore(d,b[0])},onReady:function(){this.ready=true;if(this.playOnReady){this.play()}},onPlaying:function(){if(this.playStatus<2){this.listeners.playing();this.playStatus=2}},onPause:function(){g.prototype.setTimeout.call(this,this.checkSeek,null,2000)},checkSeek:function(){if(this.stateChange===YT.PlayerState.PAUSED||this.stateChange===YT.PlayerState.ENDED){this.listeners.pause();delete this.playStatus}},onStateChange:function(a){switch(a.data){case YT.PlayerState.PLAYING:this.hasPlayed=true;this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause();break}this.stateChange=a.data},onError:function(a){this.listeners.error(a)},play:function(){var a=this;if(!this.playStatus){this.listeners.play();this.playStatus=1}if(this.ready){if(!this.hasPlayed&&(this.clickToPlay||(window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform)))){this.onPlaying()}else{this.player.playVideo()}}else{this.playOnReady=true;if(!(window.YT&&YT.Player)){this.loadAPI()}else{if(!this.player){this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){a.onReady()},onStateChange:function(b){a.onStateChange(b)},onError:function(b){a.onError(b)}}})}}}},pause:function(){if(this.ready){this.player.pauseVideo()}else{if(this.playStatus){delete this.playOnReady;this.listeners.pause();delete this.playStatus}}}});h.extend(g.prototype,{YouTubePlayer:f,textFactory:function(b,a){var d=this.options,c=this.getItemProperty(b,d.youTubeVideoIdProperty);if(c){if(this.getItemProperty(b,d.urlProperty)===undefined){b[d.urlProperty]="//www.youtube.com/watch?v="+c}if(this.getItemProperty(b,d.videoPosterProperty)===undefined){b[d.videoPosterProperty]="//img.youtube.com/vi/"+c+"/maxresdefault.jpg"}return this.videoFactory(b,a,new f(c,d.youTubePlayerVars,d.youTubeClickToPlay))}return e.call(this,b,a)}});return g}));