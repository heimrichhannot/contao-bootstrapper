(function(a){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery"],a)}else{a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}}(function(b,c){b.extend(c.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"});var a=c.prototype.handleSlide;b.extend(c.prototype,{handleSlide:function(d){a.call(this,d);if(this.playingVideo){this.playingVideo.pause()}},videoFactory:function(o,j,p){var k=this,g=this.options,q=this.elementPrototype.cloneNode(false),f=b(q),m=[{type:"error",target:q}],t=p||document.createElement("video"),i=this.getItemProperty(o,g.urlProperty),h=this.getItemProperty(o,g.typeProperty),v=this.getItemProperty(o,g.titleProperty),u=this.getItemProperty(o,g.videoPosterProperty),n,e=this.getItemProperty(o,g.videoSourcesProperty),r,l,s,d;f.addClass(g.videoContentClass);if(v){q.title=v}if(t.canPlayType){if(i&&h&&t.canPlayType(h)){t.src=i}else{while(e&&e.length){r=e.shift();i=this.getItemProperty(r,g.urlProperty);h=this.getItemProperty(r,g.typeProperty);if(i&&h&&t.canPlayType(h)){t.src=i;break}}}}if(u){t.poster=u;n=this.imagePrototype.cloneNode(false);b(n).addClass(g.toggleClass);n.src=u;n.draggable=false;q.appendChild(n)}l=document.createElement("a");l.setAttribute("target","_blank");if(!p){l.setAttribute("download",v)}l.href=i;if(t.src){t.controls=true;(p||b(t)).on("error",function(){k.setTimeout(j,m)}).on("pause",function(){s=false;f.removeClass(k.options.videoLoadingClass).removeClass(k.options.videoPlayingClass);if(d){k.container.addClass(k.options.controlsClass)}delete k.playingVideo;if(k.interval){k.play()}}).on("playing",function(){s=false;f.removeClass(k.options.videoLoadingClass).addClass(k.options.videoPlayingClass);if(k.container.hasClass(k.options.controlsClass)){d=true;k.container.removeClass(k.options.controlsClass)}else{d=false}}).on("play",function(){window.clearTimeout(k.timeout);s=true;f.addClass(k.options.videoLoadingClass);k.playingVideo=t});b(l).on("click",function(w){k.preventDefault(w);if(s){t.pause()}else{t.play()}});q.appendChild((p&&p.element)||t)}q.appendChild(l);this.setTimeout(j,[{type:"load",target:q}]);return q}});return c}));