(function(a){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery-video"],a)}else{a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}}(function(c,d){if(!window.postMessage){return d}c.extend(d.prototype.options,{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:true});var b=d.prototype.textFactory||d.prototype.imageFactory,a=function(f,g,e){this.videoId=f;this.playerVars=g;this.clickToPlay=e;this.element=document.createElement("div");this.listeners={}};c.extend(a.prototype,{canPlayType:function(){return true},on:function(e,f){this.listeners[e]=f;return this},loadAPI:function(){var h=this,e=window.onYouTubeIframeAPIReady,k="//www.youtube.com/iframe_api",j=document.getElementsByTagName("script"),f=j.length,g;window.onYouTubeIframeAPIReady=function(){if(e){e.apply(this)}if(h.playOnReady){h.play()}};while(f){f-=1;if(j[f].src===k){return}}g=document.createElement("script");g.src=k;j[0].parentNode.insertBefore(g,j[0])},onReady:function(){this.ready=true;if(this.playOnReady){this.play()}},onPlaying:function(){if(this.playStatus<2){this.listeners.playing();this.playStatus=2}},onPause:function(){d.prototype.setTimeout.call(this,this.checkSeek,null,2000)},checkSeek:function(){if(this.stateChange===YT.PlayerState.PAUSED||this.stateChange===YT.PlayerState.ENDED){this.listeners.pause();delete this.playStatus}},onStateChange:function(e){switch(e.data){case YT.PlayerState.PLAYING:this.hasPlayed=true;this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause();break}this.stateChange=e.data},onError:function(e){this.listeners.error(e)},play:function(){var e=this;if(!this.playStatus){this.listeners.play();this.playStatus=1}if(this.ready){if(!this.hasPlayed&&(this.clickToPlay||(window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform)))){this.onPlaying()}else{this.player.playVideo()}}else{this.playOnReady=true;if(!(window.YT&&YT.Player)){this.loadAPI()}else{if(!this.player){this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){e.onReady()},onStateChange:function(f){e.onStateChange(f)},onError:function(f){e.onError(f)}}})}}}},pause:function(){if(this.ready){this.player.pauseVideo()}else{if(this.playStatus){delete this.playOnReady;this.listeners.pause();delete this.playStatus}}}});c.extend(d.prototype,{YouTubePlayer:a,textFactory:function(g,h){var e=this.options,f=this.getItemProperty(g,e.youTubeVideoIdProperty);if(f){if(this.getItemProperty(g,e.urlProperty)===undefined){g[e.urlProperty]="//www.youtube.com/watch?v="+f}if(this.getItemProperty(g,e.videoPosterProperty)===undefined){g[e.videoPosterProperty]="//img.youtube.com/vi/"+f+"/maxresdefault.jpg"}return this.videoFactory(g,h,new a(f,e.youTubePlayerVars,e.youTubeClickToPlay))}return b.call(this,g,h)}});return d}));