var moment=require("../../moment");exports.format={setUp:function(a){moment.createFromInputFallback=function(){throw new Error("input not handled by moment")};a()},"format YY":function(c){c.expect(1);var a=moment(new Date(2009,1,14,15,25,50,125));c.equal(a.format("YY"),"09","YY ---> 09");c.done()},"format escape brackets":function(c){c.expect(10);moment.locale("en");var a=moment(new Date(2009,1,14,15,25,50,125));c.equal(a.format("[day]"),"day","Single bracket");c.equal(a.format("[day] YY [YY]"),"day 09 YY","Double bracket");c.equal(a.format("[YY"),"[09","Un-ended bracket");c.equal(a.format("[[YY]]"),"[YY]","Double nested brackets");c.equal(a.format("[[]"),"[","Escape open bracket");c.equal(a.format("[Last]"),"Last","localized tokens");c.equal(a.format("[L] L"),"L 02/14/2009","localized tokens with escaped localized tokens");c.equal(a.format("[L LL LLL LLLL aLa]"),"L LL LLL LLLL aLa","localized tokens with escaped localized tokens");c.equal(a.format("[LLL] LLL"),"LLL February 14, 2009 3:25 PM","localized tokens with escaped localized tokens (recursion)");c.equal(a.format("YYYY[\n]DD[\n]"),"2009\n14\n","Newlines");c.done()},"handle negative years":function(a){a.expect(10);moment.locale("en");a.equal(moment.utc().year(-1).format("YY"),"-01","YY with negative year");a.equal(moment.utc().year(-1).format("YYYY"),"-0001","YYYY with negative year");a.equal(moment.utc().year(-12).format("YY"),"-12","YY with negative year");a.equal(moment.utc().year(-12).format("YYYY"),"-0012","YYYY with negative year");a.equal(moment.utc().year(-123).format("YY"),"-23","YY with negative year");a.equal(moment.utc().year(-123).format("YYYY"),"-0123","YYYY with negative year");a.equal(moment.utc().year(-1234).format("YY"),"-34","YY with negative year");a.equal(moment.utc().year(-1234).format("YYYY"),"-1234","YYYY with negative year");a.equal(moment.utc().year(-12345).format("YY"),"-45","YY with negative year");a.equal(moment.utc().year(-12345).format("YYYY"),"-12345","YYYY with negative year");a.done()},"format milliseconds":function(c){c.expect(6);var a=moment(new Date(2009,1,14,15,25,50,123));c.equal(a.format("S"),"1","Deciseconds");c.equal(a.format("SS"),"12","Centiseconds");c.equal(a.format("SSS"),"123","Milliseconds");a.milliseconds(789);c.equal(a.format("S"),"7","Deciseconds");c.equal(a.format("SS"),"78","Centiseconds");c.equal(a.format("SSS"),"789","Milliseconds");c.done()},"format timezone":function(d){d.expect(2);var a=moment(new Date(2010,1,14,15,25,50,125)),c="moment().format('z') = "+a.format("z")+" It should be something like 'PST'";if(moment().zone()===-60){c+="For UTC+1 this is a known issue, see https://github.com/timrwood/moment/issues/162"}d.ok(a.format("Z").match(/^[\+\-]\d\d:\d\d$/),a.format("Z")+" should be something like '+07:30'");d.ok(a.format("ZZ").match(/^[\+\-]\d{4}$/),a.format("ZZ")+" should be something like '+0700'");d.done()},"format multiple with zone":function(c){c.expect(1);var a=moment("2012-10-08 -1200",["YYYY-MM-DD HH:mm ZZ","YYYY-MM-DD ZZ","YYYY-MM-DD"]);c.equals(a.format("YYYY-MM"),"2012-10","Parsing multiple formats should not crash with different sized formats");c.done()},isDST:function(g){g.expect(2);var a=new Date(2011,0,1).getTimezoneOffset(),f=new Date(2011,6,1).getTimezoneOffset(),c=a<f,e=f<a,b=moment([2011]),d=moment([2011,6]);if(c&&e){g.ok(0,"January and July cannot both be in DST");g.ok(0,"January and July cannot both be in DST")}else{if(c){g.ok(b.isDST(),"January 1 is DST");g.ok(!d.isDST(),"July 1 is not DST")}else{if(e){g.ok(!b.isDST(),"January 1 is not DST");g.ok(d.isDST(),"July 1 is DST")}else{g.ok(!b.isDST(),"January 1 is not DST");g.ok(!d.isDST(),"July 1 is not DST")}}}g.done()},"unix timestamp":function(b){b.expect(5);var a=moment("1234567890.123","X");b.equals(a.format("X"),"1234567890","unix timestamp without milliseconds");b.equals(a.format("X.S"),"1234567890.1","unix timestamp with deciseconds");b.equals(a.format("X.SS"),"1234567890.12","unix timestamp with centiseconds");b.equals(a.format("X.SSS"),"1234567890.123","unix timestamp with milliseconds");a=moment(1234567890.123,"X");b.equals(a.format("X"),"1234567890","unix timestamp as integer");b.done()},zone:function(a){a.expect(3);if(moment().zone()>0){a.ok(moment().format("ZZ").indexOf("-")>-1,"When the zone() offset is greater than 0, the ISO offset should be less than zero")}if(moment().zone()<0){a.ok(moment().format("ZZ").indexOf("+")>-1,"When the zone() offset is less than 0, the ISO offset should be greater than zero")}if(moment().zone()===0){a.ok(moment().format("ZZ").indexOf("+")>-1,"When the zone() offset is equal to 0, the ISO offset should be positive zero")}if(moment().zone()===0){a.equal(moment().zone(),0,"moment.fn.zone should be a multiple of 15 (was "+moment().zone()+")")}else{a.equal(moment().zone()%15,0,"moment.fn.zone should be a multiple of 15 (was "+moment().zone()+")")}a.equal(moment().zone(),new Date().getTimezoneOffset(),"zone should equal getTimezoneOffset");a.done()},"default format":function(b){b.expect(1);var a=/\d{4}.\d\d.\d\dT\d\d.\d\d.\d\d[\+\-]\d\d:\d\d/;b.ok(a.exec(moment().format()),"default format ("+moment().format()+") should match ISO");b.done()},"escaping quotes":function(b){b.expect(4);moment.locale("en");var a=moment([2012,0]);b.equal(a.format("MMM 'YY"),"Jan '12","Should be able to format with single parenthesis");b.equal(a.format("MMM 'YY"),"Jan '12","Should be able to format with double parenthesis");b.equal(a.format("MMM 'YY"),"Jan '12","Should be able to format with single parenthesis");b.equal(a.format("MMM 'YY"),"Jan '12","Should be able to format with double parenthesis");b.done()},toJSON:function(c){var b=typeof JSON!=="undefined"&&JSON.stringify&&JSON.stringify.call,a=moment("2012-10-09T21:30:40.678+0100");c.expect(b?2:1);c.equal(a.toJSON(),"2012-10-09T20:30:40.678Z","should output ISO8601 on moment.fn.toJSON");if(b){c.equal(JSON.stringify({date:a}),'{"date":"2012-10-09T20:30:40.678Z"}',"should output ISO8601 on JSON.stringify")}c.done()},toISOString:function(b){b.expect(4);var a=moment.utc("2012-10-09T20:30:40.678");b.equal(a.toISOString(),"2012-10-09T20:30:40.678Z","should output ISO8601 on moment.fn.toISOString");a=moment.utc("+020123-10-09T20:30:40.678");b.equal(a.toISOString(),"+020123-10-09T20:30:40.678Z","ISO8601 format on big positive year");a=moment.utc("-000001-10-09T20:30:40.678");b.equal(a.toISOString(),"-000001-10-09T20:30:40.678Z","ISO8601 format on negative year");a=moment.utc("-020123-10-09T20:30:40.678");b.equal(a.toISOString(),"-020123-10-09T20:30:40.678Z","ISO8601 format on big negative year");b.done()},"long years":function(a){a.expect(6);a.equal(moment.utc().year(2).format("YYYYYY"),"+000002","small year with YYYYYY");a.equal(moment.utc().year(2012).format("YYYYYY"),"+002012","regular year with YYYYYY");a.equal(moment.utc().year(20123).format("YYYYYY"),"+020123","big year with YYYYYY");a.equal(moment.utc().year(-1).format("YYYYYY"),"-000001","small negative year with YYYYYY");a.equal(moment.utc().year(-2012).format("YYYYYY"),"-002012","negative year with YYYYYY");a.equal(moment.utc().year(-20123).format("YYYYYY"),"-020123","big negative year with YYYYYY");a.done()},"iso week formats":function(f){var c={"2005-01-02":"2004-53","2005-12-31":"2005-52","2007-01-01":"2007-01","2007-12-30":"2007-52","2007-12-31":"2008-01","2008-01-01":"2008-01","2008-12-28":"2008-52","2008-12-29":"2009-01","2008-12-30":"2009-01","2008-12-31":"2009-01","2009-01-01":"2009-01","2009-12-31":"2009-53","2010-01-01":"2009-53","2010-01-02":"2009-53","2010-01-03":"2009-53","404-12-31":"0404-53","405-12-31":"0405-52"},b,a,d,e;for(b in c){a=c[b].split("-").pop();d=moment(b,"YYYY-MM-DD").format("WW");f.equal(a,d,b+": WW should be "+a+", but "+d);a=a.replace(/^0+/,"");e=moment(b,"YYYY-MM-DD").format("W");f.equal(a,e,b+": W should be "+a+", but "+e)}f.done()},"iso week year formats":function(g){var d={"2005-01-02":"2004-53","2005-12-31":"2005-52","2007-01-01":"2007-01","2007-12-30":"2007-52","2007-12-31":"2008-01","2008-01-01":"2008-01","2008-12-28":"2008-52","2008-12-29":"2009-01","2008-12-30":"2009-01","2008-12-31":"2009-01","2009-01-01":"2009-01","2009-12-31":"2009-53","2010-01-01":"2009-53","2010-01-02":"2009-53","2010-01-03":"2009-53","404-12-31":"0404-53","405-12-31":"0405-52"},b,f,a,c,e;for(b in d){f=d[b].split("-")[0];a=moment(b,"YYYY-MM-DD").format("GGGGG");g.equal("0"+f,a,b+": GGGGG should be "+f+", but "+a);c=moment(b,"YYYY-MM-DD").format("GGGG");g.equal(f,c,b+": GGGG should be "+f+", but "+c);e=moment(b,"YYYY-MM-DD").format("GG");g.equal(f.slice(2,4),e,b+": GG should be "+f+", but "+e)}g.done()},"week year formats":function(g){var d={"2005-01-02":"2004-53","2005-12-31":"2005-52","2007-01-01":"2007-01","2007-12-30":"2007-52","2007-12-31":"2008-01","2008-01-01":"2008-01","2008-12-28":"2008-52","2008-12-29":"2009-01","2008-12-30":"2009-01","2008-12-31":"2009-01","2009-01-01":"2009-01","2009-12-31":"2009-53","2010-01-01":"2009-53","2010-01-02":"2009-53","2010-01-03":"2009-53","404-12-31":"0404-53","405-12-31":"0405-52"},b,f,a,c,e;moment.locale("en-gb");for(b in d){f=d[b].split("-")[0];a=moment(b,"YYYY-MM-DD").format("ggggg");g.equal("0"+f,a,b+": ggggg should be "+f+", but "+a);c=moment(b,"YYYY-MM-DD").format("gggg");g.equal(f,c,b+": gggg should be "+f+", but "+c);e=moment(b,"YYYY-MM-DD").format("gg");g.equal(f.slice(2,4),e,b+": gg should be "+f+", but "+e)}g.done()},"iso weekday formats":function(a){a.expect(7);a.equal(moment([1985,1,4]).format("E"),"1","Feb  4 1985 is Monday    -- 1st day");a.equal(moment([2029,8,18]).format("E"),"2","Sep 18 2029 is Tuesday   -- 2nd day");a.equal(moment([2013,3,24]).format("E"),"3","Apr 24 2013 is Wednesday -- 3rd day");a.equal(moment([2015,2,5]).format("E"),"4","Mar  5 2015 is Thursday  -- 4th day");a.equal(moment([1970,0,2]).format("E"),"5","Jan  2 1970 is Friday    -- 5th day");a.equal(moment([2001,4,12]).format("E"),"6","May 12 2001 is Saturday  -- 6th day");a.equal(moment([2000,0,2]).format("E"),"7","Jan  2 2000 is Sunday    -- 7th day");a.done()},"weekday formats":function(a){a.expect(7);moment.locale("dow: 3,doy: 5",{week:{dow:3,doy:5}});a.equal(moment([1985,1,6]).format("e"),"0","Feb  6 1985 is Wednesday -- 0th day");a.equal(moment([2029,8,20]).format("e"),"1","Sep 20 2029 is Thursday  -- 1st day");a.equal(moment([2013,3,26]).format("e"),"2","Apr 26 2013 is Friday    -- 2nd day");a.equal(moment([2015,2,7]).format("e"),"3","Mar  7 2015 is Saturday  -- 3nd day");a.equal(moment([1970,0,4]).format("e"),"4","Jan  4 1970 is Sunday    -- 4th day");a.equal(moment([2001,4,14]).format("e"),"5","May 14 2001 is Monday    -- 5th day");a.equal(moment([2000,0,4]).format("e"),"6","Jan  4 2000 is Tuesday   -- 6th day");a.done()},"toString is just human readable format":function(c){c.expect(1);var a=moment(new Date(2009,1,5,15,25,50,125));c.equal(a.toString(),a.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ"));c.done()},"toJSON skips postformat":function(a){a.expect(1);moment.locale("postformat",{postformat:function(b){b.replace(/./g,"X")}});a.equal(moment.utc([2000,0,1]).toJSON(),"2000-01-01T00:00:00.000Z","toJSON doesn't postformat");moment.locale("postformat",null);a.done()},"calendar day timezone":function(m){m.expect(11);moment.locale("en");var g=[60,-60,90,-90,360,-360,720,-720],e=moment().utc().startOf("day").subtract({m:1}),l=moment().local().startOf("day").subtract({m:1}),k=moment().local().startOf("day").subtract({d:2}),h,j,f;for(h=0;h<g.length;++h){j=g[h];f=moment().zone(j).startOf("day").subtract({m:1});m.equal(moment(f).zone(j).calendar(),"Yesterday at 11:59 PM","Yesterday at 11:59 PM, not Today, or the wrong time")}m.equal(moment(e).utc().calendar(),"Yesterday at 11:59 PM","Yesterday at 11:59 PM, not Today, or the wrong time");m.equal(moment(l).local().calendar(),"Yesterday at 11:59 PM","Yesterday at 11:59 PM, not Today, or the wrong time");m.equal(moment(l).local().calendar(k),"Tomorrow at 11:59 PM","Tomorrow at 11:59 PM, not Yesterday, or the wrong time");m.done()},invalid:function(a){moment.locale("en");a.equal(moment.invalid().format(),"Invalid date");a.equal(moment.invalid().format("YYYY-MM-DD"),"Invalid date");a.done()},"quarter formats":function(a){a.expect(7);a.equal(moment([1985,1,4]).format("Q"),"1","Feb  4 1985 is Q1");a.equal(moment([2029,8,18]).format("Q"),"3","Sep 18 2029 is Q3");a.equal(moment([2013,3,24]).format("Q"),"2","Apr 24 2013 is Q2");a.equal(moment([2015,2,5]).format("Q"),"1","Mar  5 2015 is Q1");a.equal(moment([1970,0,2]).format("Q"),"1","Jan  2 1970 is Q1");a.equal(moment([2001,11,12]).format("Q"),"4","Dec 12 2001 is Q4");a.equal(moment([2000,0,2]).format("[Q]Q-YYYY"),"Q1-2000","Jan  2 2000 is Q1");a.done()}};