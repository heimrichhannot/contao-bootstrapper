var fs=require("fs");module.exports=function(d){var a="/usr/share/zoneinfo/zone.tab";d.registerTask("zones","Run the unit tests in different timezones.",function(){var e=this.async();b(function(h,f){if(h!=null){throw h}(function g(j){if(j>=f.length){return e()}c(f[j],function(i){if(i!=null){throw i}g(j+1)})}(0))})});function b(e){fs.readFile(a,"ascii",function(g,f){if(g!=null){e(g)}e(null,f.split(/\r\n|\r|\n/).filter(function(h){return h&&!/^#/.test(h)}).map(function(h){return h.split("\t")[2]}))})}function c(e,f){d.log.ok("Running tests in zone "+e);d.util.spawn({cmd:"grunt",opts:{env:{PATH:process.env.PATH,TZ:e}},args:["--no-color","nodeunit"]},function(i,g,h){if(h!==0){d.log.error(g.stdout.split(/\r\n|\r|\n/).filter(function(j){return/^(>>|Warning:|$)/.test(j)}).map(function(j){return(j.substr(0,3)===">> "?j.substr(3):j)}).join("\n"))}f()})}};