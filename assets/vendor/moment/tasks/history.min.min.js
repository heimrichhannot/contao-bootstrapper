var https=require("https"),zlib=require("zlib"),path=require("path"),fs=require("fs");var count=0;var resolved=0;var outputs=[];var done;function check(){if(resolved===count){normalize();display()}}function makeBar(c){var d="";while(d.length<c){d+="="}return d}function normalize(){var f,e=0,d=0;for(f=0;f<count;f++){e=Math.max(e,outputs[f].gzip);d=Math.max(d,outputs[f].original)}for(f=0;f<count;f++){outputs[f].bargraph=makeBar((outputs[f].gzip/e)*80);outputs[f].bargraph2=makeBar((outputs[f].original/d)*80)}}function display(){var b;for(b=0;b<count;b++){console.log(outputs[b].version+" "+outputs[b].gzip+" "+outputs[b].original);console.log("gzip "+outputs[b].bargraph);console.log("orig "+outputs[b].bargraph2)}done()}function getSizeAtVersion(g,i){var j="",h={},f=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+g+i},function(a){a.setEncoding("utf8");a.on("data",function(b){j+=b});a.on("end",function(b){zlib.gzip(j,function(c,d){h.version=g;h.gzip=d.length;h.original=j.length;resolved++;check()})})});f.on("error",function(a){console.log("problem with request: "+a.message)});f.end();count++;outputs.push(h)}function getRemote(){var f="1.0.1 1.1.0 1.1.1 1.1.2 1.2.0 1.3.0 1.4.0".split(" "),d="1.5.0 1.5.1 1.6.0 1.6.1 1.7.0 1.7.1".split(" "),e;for(e=0;e<f.length;e++){getSizeAtVersion(f[e],"/moment.min.js")}for(e=0;e<d.length;e++){getSizeAtVersion(d[e],"/min/moment.min.js")}}function getLocal(){count++;var b={};outputs.push(b);fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(a,d){if(a){throw a}zlib.gzip(d,function(c,f){b.version=".next";b.gzip=f.length;b.original=d.length;resolved++;check()})})}module.exports=function(b){b.registerTask("history","Check the codebase filesize over different releases.",function(){done=this.async();getRemote();getLocal()})};