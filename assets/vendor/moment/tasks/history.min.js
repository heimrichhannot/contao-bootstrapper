var https=require("https"),zlib=require("zlib"),path=require("path"),fs=require("fs");var count=0;var resolved=0;var outputs=[];var done;function check(){if(resolved===count){normalize();display()}}function makeBar(b){var a="";while(a.length<b){a+="="}return a}function normalize(){var c,a=0,b=0;for(c=0;c<count;c++){a=Math.max(a,outputs[c].gzip);b=Math.max(b,outputs[c].original)}for(c=0;c<count;c++){outputs[c].bargraph=makeBar((outputs[c].gzip/a)*80);outputs[c].bargraph2=makeBar((outputs[c].original/b)*80)}}function display(){var a;for(a=0;a<count;a++){console.log(outputs[a].version+" "+outputs[a].gzip+" "+outputs[a].original);console.log("gzip "+outputs[a].bargraph);console.log("orig "+outputs[a].bargraph2)}done()}function getSizeAtVersion(a,d){var c="",e={},b=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+a+d},function(f){f.setEncoding("utf8");f.on("data",function(g){c+=g});f.on("end",function(g){zlib.gzip(c,function(i,h){e.version=a;e.gzip=h.length;e.original=c.length;resolved++;check()})})});b.on("error",function(f){console.log("problem with request: "+f.message)});b.end();count++;outputs.push(e)}function getRemote(){var c="1.0.1 1.1.0 1.1.1 1.1.2 1.2.0 1.3.0 1.4.0".split(" "),b="1.5.0 1.5.1 1.6.0 1.6.1 1.7.0 1.7.1".split(" "),a;for(a=0;a<c.length;a++){getSizeAtVersion(c[a],"/moment.min.js")}for(a=0;a<b.length;a++){getSizeAtVersion(b[a],"/min/moment.min.js")}}function getLocal(){count++;var a={};outputs.push(a);fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(b,c){if(b){throw b}zlib.gzip(c,function(e,d){a.version=".next";a.gzip=d.length;a.original=c.length;resolved++;check()})})}module.exports=function(a){a.registerTask("history","Check the codebase filesize over different releases.",function(){done=this.async();getRemote();getLocal()})};