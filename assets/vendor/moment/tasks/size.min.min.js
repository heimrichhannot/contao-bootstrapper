var https=require("https"),zlib=require("zlib"),path=require("path"),fs=require("fs");var stable="1.7.1",done;function getVersion(g,f){var h="",e=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+g},function(a){a.setEncoding("utf8");a.on("data",function(b){h+=b});a.on("end",function(b){zlib.gzip(h,function(c,d){f(h.length,d.length)})})});e.on("error",function(a){console.log("problem with request: "+a.message)});e.end()}function printDiffs(g,i,k,l){var j=k-g,h=l-i;console.log("Filesize difference from current branch to "+stable);console.log(stable+"   "+g+" / "+i);console.log("curr    "+k+" / "+l);console.log("diff    "+(j>0?"+":"")+j);console.log("gzip    "+(h>0?"+":"")+h)}module.exports=function(b){b.registerTask("size","Check the codebase filesize against the latest stable version.",function(){done=this.async();fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(a,d){if(a){throw a}zlib.gzip(d,function(c,f){getVersion(stable+"/min/moment.min.js",function(e,h){printDiffs(e,h,d.length,f.length);done()})})})})};