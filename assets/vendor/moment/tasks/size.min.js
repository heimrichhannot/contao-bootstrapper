var https=require("https"),zlib=require("zlib"),path=require("path"),fs=require("fs");var stable="1.7.1",done;function getVersion(d,a){var c="",b=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+d},function(e){e.setEncoding("utf8");e.on("data",function(f){c+=f});e.on("end",function(f){zlib.gzip(c,function(h,g){a(c.length,g.length)})})});b.on("error",function(f){console.log("problem with request: "+f.message)});b.end()}function printDiffs(b,f,d,c){var e=d-b,a=c-f;console.log("Filesize difference from current branch to "+stable);console.log(stable+"   "+b+" / "+f);console.log("curr    "+d+" / "+c);console.log("diff    "+(e>0?"+":"")+e);console.log("gzip    "+(a>0?"+":"")+a)}module.exports=function(a){a.registerTask("size","Check the codebase filesize against the latest stable version.",function(){done=this.async();fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(b,c){if(b){throw b}zlib.gzip(c,function(e,d){getVersion(stable+"/min/moment.min.js",function(g,f){printDiffs(g,f,c.length,d.length);done()})})})})};