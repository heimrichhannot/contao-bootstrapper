define(["../core","./var/nonce","./var/rquery","../ajax"],function(h,j,f){var g=[],i=/(=)\?(?=&|$)|\?\?/;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=g.pop()||(h.expando+"_"+(j++));this[a]=true;return a}});h.ajaxPrefilter("json jsonp",function(d,n,c){var a,m,e,b=d.jsonp!==false&&(i.test(d.url)?"url":typeof d.data==="string"&&!(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&i.test(d.data)&&"data");if(b||d.dataTypes[0]==="jsonp"){a=d.jsonpCallback=h.isFunction(d.jsonpCallback)?d.jsonpCallback():d.jsonpCallback;if(b){d[b]=d[b].replace(i,"$1"+a)}else{if(d.jsonp!==false){d.url+=(f.test(d.url)?"&":"?")+d.jsonp+"="+a}}d.converters["script json"]=function(){if(!e){h.error(a+" was not called")}return e[0]};d.dataTypes[0]="json";m=window[a];window[a]=function(){e=arguments};c.always(function(){window[a]=m;if(d[a]){d.jsonpCallback=n.jsonpCallback;g.push(a)}if(e&&h.isFunction(m)){m(e[0])}e=m=undefined});return"script"}})});