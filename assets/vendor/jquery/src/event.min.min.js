define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(o,w,r,v,t,s,B){var p=/^key/,y=/^(?:mouse|pointer|contextmenu)|click/,u=/^(?:focusinfocus|focusoutblur)$/,z=/^([^.]*)(?:\.(.+)|)$/;function x(){return true}function A(){return false}function q(){try{return document.activeElement}catch(a){}}o.event={global:{},add:function(I,j,G,m,n){var d,k,l,H,b,c,h,a,f,g,e,i=B.get(I);if(!i){return}if(G.handler){d=G;G=d.handler;n=d.selector}if(!G.guid){G.guid=o.guid++}if(!(H=i.events)){H=i.events={}}if(!(k=i.handle)){k=i.handle=function(C){return typeof o!==w&&o.event.triggered!==C.type?o.event.dispatch.apply(I,arguments):undefined}}j=(j||"").match(r)||[""];b=j.length;while(b--){l=z.exec(j[b])||[];f=e=l[1];g=(l[2]||"").split(".").sort();if(!f){continue}h=o.event.special[f]||{};f=(n?h.delegateType:h.bindType)||f;h=o.event.special[f]||{};c=o.extend({type:f,origType:e,data:m,handler:G,guid:G.guid,selector:n,needsContext:n&&o.expr.match.needsContext.test(n),namespace:g.join(".")},d);if(!(a=H[f])){a=H[f]=[];a.delegateCount=0;if(!h.setup||h.setup.call(I,m,g,k)===false){if(I.addEventListener){I.addEventListener(f,k,false)}}}if(h.add){h.add.call(I,c);if(!c.handler.guid){c.handler.guid=G.guid}}if(n){a.splice(a.delegateCount++,0,c)}else{a.push(c)}o.event.global[f]=true}},remove:function(b,j,G,I,k){var m,n,l,H,a,d,h,c,f,g,e,i=B.hasData(b)&&B.get(b);if(!i||!(H=i.events)){return}j=(j||"").match(r)||[""];a=j.length;while(a--){l=z.exec(j[a])||[];f=e=l[1];g=(l[2]||"").split(".").sort();if(!f){for(f in H){o.event.remove(b,f+j[a],G,I,true)}continue}h=o.event.special[f]||{};f=(I?h.delegateType:h.bindType)||f;c=H[f]||[];l=l[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)");n=m=c.length;while(m--){d=c[m];if((k||e===d.origType)&&(!G||G.guid===d.guid)&&(!l||l.test(d.namespace))&&(!I||I===d.selector||I==="**"&&d.selector)){c.splice(m,1);if(d.selector){c.delegateCount--}if(h.remove){h.remove.call(b,d)}}}if(n&&!c.length){if(!h.teardown||h.teardown.call(b,g,i.handle)===false){o.removeEvent(b,f,i.handle)}delete H[f]}}if(o.isEmptyObject(H)){delete i.handle;B.remove(b,"events")}},trigger:function(e,m,a,d){var l,g,k,f,b,j,i,n=[a||document],h=v.call(e,"type")?e.type:e,c=v.call(e,"namespace")?e.namespace.split("."):[];g=k=a=a||document;if(a.nodeType===3||a.nodeType===8){return}if(u.test(h+o.event.triggered)){return}if(h.indexOf(".")>=0){c=h.split(".");h=c.shift();c.sort()}b=h.indexOf(":")<0&&"on"+h;e=e[o.expando]?e:new o.Event(h,typeof e==="object"&&e);e.isTrigger=d?2:3;e.namespace=c.join(".");e.namespace_re=e.namespace?new RegExp("(^|\\.)"+c.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;e.result=undefined;if(!e.target){e.target=a}m=m==null?[e]:o.makeArray(m,[e]);i=o.event.special[h]||{};if(!d&&i.trigger&&i.trigger.apply(a,m)===false){return}if(!d&&!i.noBubble&&!o.isWindow(a)){f=i.delegateType||h;if(!u.test(f+h)){g=g.parentNode}for(;g;g=g.parentNode){n.push(g);k=g}if(k===(a.ownerDocument||document)){n.push(k.defaultView||k.parentWindow||window)}}l=0;while((g=n[l++])&&!e.isPropagationStopped()){e.type=l>1?f:i.bindType||h;j=(B.get(g,"events")||{})[e.type]&&B.get(g,"handle");if(j){j.apply(g,m)}j=b&&g[b];if(j&&j.apply&&o.acceptData(g)){e.result=j.apply(g,m);if(e.result===false){e.preventDefault()}}}e.type=h;if(!d&&!e.isDefaultPrevented()){if((!i._default||i._default.apply(n.pop(),m)===false)&&o.acceptData(a)){if(b&&o.isFunction(a[h])&&!o.isWindow(a)){k=a[b];if(k){a[b]=null}o.event.triggered=h;a[h]();o.event.triggered=undefined;if(k){a[b]=k}}}}return e.result},dispatch:function(d){d=o.event.fix(d);var j,a,i,c,e,f=[],g=t.call(arguments),b=(B.get(this,"events")||{})[d.type]||[],h=o.event.special[d.type]||{};g[0]=d;d.delegateTarget=this;if(h.preDispatch&&h.preDispatch.call(this,d)===false){return}f=o.event.handlers.call(this,d,b);j=0;while((c=f[j++])&&!d.isPropagationStopped()){d.currentTarget=c.elem;a=0;while((e=c.handlers[a++])&&!d.isImmediatePropagationStopped()){if(!d.namespace_re||d.namespace_re.test(e.namespace)){d.handleObj=e;d.data=e.data;i=((o.event.special[e.origType]||{}).handle||e.handler).apply(c.elem,g);if(i!==undefined){if((d.result=i)===false){d.preventDefault();d.stopPropagation()}}}}}if(h.postDispatch){h.postDispatch.call(this,d)}return d.result},handlers:function(d,b){var i,h,c,f,g=[],a=b.delegateCount,e=d.target;if(a&&e.nodeType&&(!d.button||d.type!=="click")){for(;e!==this;e=e.parentNode||this){if(e.disabled!==true||d.type!=="click"){h=[];for(i=0;i<a;i++){f=b[i];c=f.selector+" ";if(h[c]===undefined){h[c]=f.needsContext?o(c,this).index(e)>=0:o.find(c,this,null,[e]).length}if(h[c]){h.push(f)}}if(h.length){g.push({elem:e,handlers:h})}}}}if(a<b.length){g.push({elem:this,handlers:b.slice(a)})}return g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){if(a.which==null){a.which=b.charCode!=null?b.charCode:b.keyCode}return a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(c,d){var b,a,f,e=d.button;if(c.pageX==null&&d.clientX!=null){b=c.target.ownerDocument||document;a=b.documentElement;f=b.body;c.pageX=d.clientX+(a&&a.scrollLeft||f&&f.scrollLeft||0)-(a&&a.clientLeft||f&&f.clientLeft||0);c.pageY=d.clientY+(a&&a.scrollTop||f&&f.scrollTop||0)-(a&&a.clientTop||f&&f.clientTop||0)}if(!c.which&&e!==undefined){c.which=(e&1?1:(e&2?3:(e&4?2:0)))}return c}},fix:function(d){if(d[o.expando]){return d}var f,a,b,e=d.type,g=d,c=this.fixHooks[e];if(!c){this.fixHooks[e]=c=y.test(e)?this.mouseHooks:p.test(e)?this.keyHooks:{}}b=c.props?this.props.concat(c.props):this.props;d=new o.Event(g);f=b.length;while(f--){a=b[f];d[a]=g[a]}if(!d.target){d.target=document}if(d.target.nodeType===3){d.target=d.target.parentNode}return c.filter?c.filter(d,g):d},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==q()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===q()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&o.nodeName(this,"input")){this.click();return false}},_default:function(a){return o.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){if(a.result!==undefined&&a.originalEvent){a.originalEvent.returnValue=a.result}}}},simulate:function(d,b,c,e){var a=o.extend(new o.Event(),c,{type:d,isSimulated:true,originalEvent:{}});if(e){o.event.trigger(a,null,b)}else{o.event.dispatch.call(b,a)}if(a.isDefaultPrevented()){c.preventDefault()}}};o.removeEvent=function(b,c,a){if(b.removeEventListener){b.removeEventListener(c,a,false)}};o.Event=function(a,b){if(!(this instanceof o.Event)){return new o.Event(a,b)}if(a&&a.type){this.originalEvent=a;this.type=a.type;this.isDefaultPrevented=a.defaultPrevented||a.defaultPrevented===undefined&&a.returnValue===false?x:A}else{this.type=a}if(b){o.extend(this,b)}this.timeStamp=a&&a.timeStamp||o.now();this[o.expando]=true};o.Event.prototype={isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=x;if(a&&a.preventDefault){a.preventDefault()}},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=x;if(a&&a.stopPropagation){a.stopPropagation()}},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=x;if(a&&a.stopImmediatePropagation){a.stopImmediatePropagation()}this.stopPropagation()}};o.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){o.event.special[a]={delegateType:b,bindType:b,handle:function(e){var g,c=this,d=e.relatedTarget,f=e.handleObj;if(!d||(d!==c&&!o.contains(c,d))){e.type=f.origType;g=f.handler.apply(this,arguments);e.type=b}return g}}});if(!s.focusinBubbles){o.each({focus:"focusin",blur:"focusout"},function(a,c){var b=function(d){o.event.simulate(c,d.target,o.event.fix(d),true)};o.event.special[c]={setup:function(){var d=this.ownerDocument||this,e=B.access(d,c);if(!e){d.addEventListener(a,b,true)}B.access(d,c,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=B.access(d,c)-1;if(!e){d.removeEventListener(a,b,true);B.remove(d,c)}else{B.access(d,c,e)}}}})}o.fn.extend({on:function(e,g,b,c,f){var a,d;if(typeof e==="object"){if(typeof g!=="string"){b=b||g;g=undefined}for(d in e){this.on(d,g,b,e[d],f)}return this}if(b==null&&c==null){c=g;b=g=undefined}else{if(c==null){if(typeof g==="string"){c=b;b=undefined}else{c=b;b=g;g=undefined}}}if(c===false){c=A}else{if(!c){return this}}if(f===1){a=c;c=function(h){o().off(h);return a.apply(this,arguments)};c.guid=a.guid||(a.guid=o.guid++)}return this.each(function(){o.event.add(this,e,c,b,g)})},one:function(c,d,a,b){return this.on(c,d,a,b,1)},off:function(c,e,a){var d,b;if(c&&c.preventDefault&&c.handleObj){d=c.handleObj;o(c.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler);return this}if(typeof c==="object"){for(b in c){this.off(b,e,c[b])}return this}if(e===false||typeof e==="function"){a=e;e=undefined}if(a===false){a=A}return this.each(function(){o.event.remove(this,c,a,e)})},trigger:function(b,a){return this.each(function(){o.event.trigger(b,a,this)})},triggerHandler:function(c,a){var b=this[0];if(b){return o.event.trigger(c,a,b,true)}}});return o});