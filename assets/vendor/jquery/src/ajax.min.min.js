define(["./core","./var/rnotwhite","./ajax/var/nonce","./ajax/var/rquery","./core/init","./ajax/parseJSON","./ajax/parseXML","./deferred"],function(E,A,z,J){var G=/#.*$/,N=/([?&])_=[^&]*/,P=/^(.*?):[ \t]*([^\r\n]*)$/mg,M=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,K=/^(?:GET|HEAD)$/,H=/^\/\//,L=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,v={},x={},F="*/".concat("*"),w=window.location.href,I=L.exec(w.toLowerCase())||[];function D(a){return function(e,c){if(typeof e!=="string"){c=e;e="*"}var d,b=0,f=e.toLowerCase().match(A)||[];if(E.isFunction(c)){while((d=f[b++])){if(d[0]==="+"){d=d.slice(1)||"*";(a[d]=a[d]||[]).unshift(c)}else{(a[d]=a[d]||[]).push(c)}}}}}function B(d,b,g,f){var c={},e=(d===x);function a(i){var h;c[i]=true;E.each(d[i]||[],function(k,l){var j=l(b,g,f);if(typeof j==="string"&&!e&&!c[j]){b.dataTypes.unshift(j);a(j);return false}else{if(e){return !(h=j)}}});return h}return a(b.dataTypes[0])||!c["*"]&&a("*")}function C(a,e){var b,c,d=E.ajaxSettings.flatOptions||{};for(b in e){if(e[b]!==undefined){(d[b]?a:(c||(c={})))[b]=e[b]}}if(c){E.extend(true,a,c)}return a}function y(a,b,e){var f,d,g,i,h=a.contents,c=a.dataTypes;while(c[0]==="*"){c.shift();if(f===undefined){f=a.mimeType||b.getResponseHeader("Content-Type")}}if(f){for(d in h){if(h[d]&&h[d].test(f)){c.unshift(d);break}}}if(c[0] in e){g=c[0]}else{for(d in e){if(!c[0]||a.converters[d+" "+c[0]]){g=d;break}if(!i){i=d}}g=g||i}if(g){if(g!==c[0]){c.unshift(g)}return e[g]}}function O(j,f,a,h){var i,c,l,e,g,k={},b=j.dataTypes.slice();if(b[1]){for(l in j.converters){k[l.toLowerCase()]=j.converters[l]}}c=b.shift();while(c){if(j.responseFields[c]){a[j.responseFields[c]]=f}if(!g&&h&&j.dataFilter){f=j.dataFilter(f,j.dataType)}g=c;c=b.shift();if(c){if(c==="*"){c=g}else{if(g!=="*"&&g!==c){l=k[g+" "+c]||k["* "+c];if(!l){for(i in k){e=i.split(" ");if(e[1]===c){l=k[g+" "+e[0]]||k["* "+e[0]];if(l){if(l===true){l=k[i]}else{if(k[i]!==true){c=e[0];b.unshift(e[1])}}break}}}}if(l!==true){if(l&&j["throws"]){f=l(f)}else{try{f=l(f)}catch(d){return{state:"parsererror",error:l?d:"No conversion from "+g+" to "+c}}}}}}}}return{state:"success",data:f}}E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:w,type:"GET",isLocal:M.test(I[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":F,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":E.parseJSON,"text xml":E.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(a,b){return b?C(C(a,E.ajaxSettings),b):C(E.ajaxSettings,a)},ajaxPrefilter:D(v),ajaxTransport:D(x),ajax:function(i,o){if(typeof i==="object"){o=i;i=undefined}o=o||{};var g,T,c,m,s,l,q,h,t=E.ajaxSetup({},o),a=t.context||t,p=t.context&&(a.nodeType||a.jquery)?E(a):E.event,b=E.Deferred(),e=E.Callbacks("once memory"),S=t.statusCode||{},n={},d={},k=0,u="canceled",j={readyState:0,getResponseHeader:function(Q){var R;if(k===2){if(!m){m={};while((R=P.exec(c))){m[R[1].toLowerCase()]=R[2]}}R=m[Q.toLowerCase()]}return R==null?null:R},getAllResponseHeaders:function(){return k===2?c:null},setRequestHeader:function(R,Q){var V=R.toLowerCase();if(!k){R=d[V]=d[V]||R;n[R]=Q}return this},overrideMimeType:function(Q){if(!k){t.mimeType=Q}return this},statusCode:function(Q){var R;if(Q){if(k<2){for(R in Q){S[R]=[S[R],Q[R]]}}else{j.always(Q[j.status])}}return this},abort:function(Q){var R=Q||u;if(g){g.abort(R)}r(0,R);return this}};b.promise(j).complete=e.add;j.success=j.done;j.error=j.fail;t.url=((i||t.url||w)+"").replace(G,"").replace(H,I[1]+"//");t.type=o.method||o.type||t.method||t.type;t.dataTypes=E.trim(t.dataType||"*").toLowerCase().match(A)||[""];if(t.crossDomain==null){l=L.exec(t.url.toLowerCase());t.crossDomain=!!(l&&(l[1]!==I[1]||l[2]!==I[2]||(l[3]||(l[1]==="http:"?"80":"443"))!==(I[3]||(I[1]==="http:"?"80":"443"))))}if(t.data&&t.processData&&typeof t.data!=="string"){t.data=E.param(t.data,t.traditional)}B(v,t,o,j);if(k===2){return j}q=E.event&&t.global;if(q&&E.active++===0){E.event.trigger("ajaxStart")}t.type=t.type.toUpperCase();t.hasContent=!K.test(t.type);T=t.url;if(!t.hasContent){if(t.data){T=(t.url+=(J.test(T)?"&":"?")+t.data);delete t.data}if(t.cache===false){t.url=N.test(T)?T.replace(N,"$1_="+z++):T+(J.test(T)?"&":"?")+"_="+z++}}if(t.ifModified){if(E.lastModified[T]){j.setRequestHeader("If-Modified-Since",E.lastModified[T])}if(E.etag[T]){j.setRequestHeader("If-None-Match",E.etag[T])}}if(t.data&&t.hasContent&&t.contentType!==false||o.contentType){j.setRequestHeader("Content-Type",t.contentType)}j.setRequestHeader("Accept",t.dataTypes[0]&&t.accepts[t.dataTypes[0]]?t.accepts[t.dataTypes[0]]+(t.dataTypes[0]!=="*"?", "+F+"; q=0.01":""):t.accepts["*"]);for(h in t.headers){j.setRequestHeader(h,t.headers[h])}if(t.beforeSend&&(t.beforeSend.call(a,j,t)===false||k===2)){return j.abort()}u="abort";for(h in {success:1,error:1,complete:1}){j[h](t[h])}g=B(x,t,o,j);if(!g){r(-1,"No Transport")}else{j.readyState=1;if(q){p.trigger("ajaxSend",[j,t])}if(t.async&&t.timeout>0){s=setTimeout(function(){j.abort("timeout")},t.timeout)}try{k=1;g.send(n,r)}catch(f){if(k<2){r(-1,f)}else{throw f}}}function r(ac,ag,aa,ae){var ah,ai,R,ad,Q,af=ag;if(k===2){return}k=2;if(s){clearTimeout(s)}g=undefined;c=ae||"";j.readyState=ac>0?4:0;ah=ac>=200&&ac<300||ac===304;if(aa){ad=y(t,j,aa)}ad=O(t,ad,j,ah);if(ah){if(t.ifModified){Q=j.getResponseHeader("Last-Modified");if(Q){E.lastModified[T]=Q}Q=j.getResponseHeader("etag");if(Q){E.etag[T]=Q}}if(ac===204||t.type==="HEAD"){af="nocontent"}else{if(ac===304){af="notmodified"}else{af=ad.state;ai=ad.data;R=ad.error;ah=!R}}}else{R=af;if(ac||!af){af="error";if(ac<0){ac=0}}}j.status=ac;j.statusText=(ag||af)+"";if(ah){b.resolveWith(a,[ai,af,j])}else{b.rejectWith(a,[j,af,R])}j.statusCode(S);S=undefined;if(q){p.trigger(ah?"ajaxSuccess":"ajaxError",[j,t,ah?ai:R])}e.fireWith(a,[j,af]);if(q){p.trigger("ajaxComplete",[j,t]);if(!(--E.active)){E.event.trigger("ajaxStop")}}}return j},getJSON:function(c,b,a){return E.get(c,b,a,"json")},getScript:function(b,a){return E.get(b,undefined,a,"script")}});E.each(["get","post"],function(b,a){E[a]=function(d,e,c,f){if(E.isFunction(e)){f=f||c;c=e;e=undefined}return E.ajax({url:d,type:a,dataType:f,data:e,success:c})}});return E});